---
title: 前端系统设计与优化
date: '2020-06-26'
tags: ['面试']
draft: false
---

# 系统设计和优化题目：应对思路与规律总结

在面试中，**系统设计和优化类问题**是一类常见的高频题目。这类问题往往没有标准答案，回答的上下限差距较大。初次遇到时，可能会觉得思路混乱、难以组织答案。
以下是我结合一些实际题目和个人总结的方法，希望为大家提供一套**应对这类问题的通用套路**。

---

## **常见题目与示例答案**

### 1. **如何做性能优化？**
**问题核心**：性能——页面加载速度和页面流畅度。

- **关键指标**：
  - 页面加载时长（如首屏加载时间、白屏时间）。
  - 帧率（每秒帧数 FPS）。

- **衡量方法**：
  - 加载时长：使用 `performance.timing`、API 上报、监听 `onload` 和 `DOMContentLoaded` 等事件。
  - 帧率：使用 `requestAnimationFrame` (`raf`) 计算帧间隔。

- **优化方法**：
  针对用户访问的全流程，每个阶段逐步优化：
  1. **网络优化**：减少 DNS 查询时间、开启 HTTP/2、启用 CDN、使用长连接、开启资源缓存等。
  2. **资源优化**：合并 CSS/JS 文件、图片懒加载、Tree Shaking、按需加载等。
  3. **渲染优化**：减少 DOM 操作、避免长任务阻塞主线程、使用虚拟 DOM。
  4. **交互优化**：提升帧率，避免动画掉帧。

---

### 2. **如何提升代码质量？**
**问题核心**：代码质量——代码是否高效、稳定、可维护。

- **关键指标**：
  - 代码性能（运行效率、资源占用）。
  - 缺陷数量（如 Bug、异常、易混淆逻辑等）。
  - 可维护性（代码结构是否清晰、易读）。

- **衡量方法**：
  - 使用静态代码分析工具（如 ESLint）。
  - 单元测试覆盖率。
  - Bug 数量统计。

- **优化方法**：
  - **流程优化**：
    1. **需求评审**：明确需求，减少需求变更。
    2. **代码初始化**：提供统一的脚手架或代码模板。
    3. **代码检查**：配置 ESLint 或 Prettier。
    4. **提交检查**：在 `git commit` 阶段设置钩子（如 Husky）检查代码风格和测试结果。
    5. **测试阶段**：完善单元测试、集成测试。
    6. **发布阶段**：规则拦截（如检测文件体积过大、非必要资源重复加载）。
    7. **上线后监控**：通过埋点系统或日志分析监控 Bug 和性能问题。

---

### 3. **如何设计埋点系统？**
**问题核心**：数据的采集与处理。

- **关键问题**：
  1. 采集哪些数据？
     - 性能数据（如加载时间、帧率）。
     - 用户行为（如点击、滚动、操作路径）。
     - 错误监控（如运行时错误、API 错误）。
  2. 如何上报数据？
     - 使用 `AJAX` 或创建 `<img>` 标签，通过 URL 参数携带数据。
     - `navigator.sendBeacon` 确保页面卸载时数据可靠发送。
  3. 数据如何处理和利用？
     - 数据清洗、归类存储。
     - 构建可视化平台（如报表、权限管理）。
     - 设置报警和监控规则。

---

### 4. **如何优化 webpack？**
**问题核心**：**缩小打包体积** 和 **减少打包时间**。

- **优化方向**：
  1. **缩小体积**：
     - 开启 Tree Shaking（删除无用代码）。
     - 使用 SplitChunks 分割代码。
     - 图片压缩、CSS 压缩、JS 压缩（TerserPlugin）。
  2. **减少打包时间**：
     - 使用 `cache` 缓存打包结果。
     - 使用多线程打包（如 ThreadLoader）。
     - 配置 `include` 和 `exclude` 过滤范围。
     - 减少入口文件的数量。

- **切入点**：
  按照 webpack 的打包流程逐步分析：
  1. 初始化参数。
  2. 加载插件。
  3. 确定入口。
  4. 编译模块。
  5. 输出资源。
  6. 写入文件。

---

### 5. **如何提升开发效率？**
**问题核心**：**团队和个人的工作效率**。

- **衡量指标**：
  - 人日成本：完成任务的时间和人力资源投入。
  - 需求交付周期。

- **提升方法**：
  - **流程优化**：与代码质量优化类似，优化从需求评审到上线的每个环节。
  - **工具辅助**：开发统一的脚手架、自动化 CI/CD 工具。
  - **任务分配优化**：根据成员擅长领域合理分配任务。

---

### 6. **如何设计客户端离线资源系统？**
**问题核心**：资源的管理与更新。

- **关键问题**：
  1. **发放资源**：明确发放什么资源、在什么时间发放。
  2. **资源更新**：确定资源的优先级、有效期。
  3. **资源存储**：使用缓存 API（如 Service Worker）。
  4. **资源使用**：定义加载优先级和使用场景。

---

## **总结与应对思路**

1. **找到问题的关键点**：
   - 明确问题的核心，如性能、代码质量、效率、资源等。
   - 定义核心关键点，如指标、数据或操作对象。

2. **衡量指标**：
   - 确定问题的衡量方法，例如：
     - 性能问题通过加载时长和帧率衡量。
     - 代码质量通过 Bug 数量和可维护性评估。

3. **全流程分析**：
   - 根据问题涉及的系统或流程，从头到尾逐步拆解。
   - 针对每个环节逐一优化。

4. **通用结构**：
   - **关键点** → **衡量方法** → **优化方向** → **具体实践**。

---

希望通过这些例题和总结方法，大家能够在面试和实际工作中**快速抓住重点**，有条理地分析和解决系统设计与优化问题。